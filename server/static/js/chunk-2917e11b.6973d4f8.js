(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2917e11b"],{"24d4":function(t,e,a){},"44a5":function(t,e,a){},"450a":function(t,e,a){"use strict";a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return l})),a.d(e,"b",(function(){return r})),a.d(e,"d",(function(){return i}));var n=a("b775");function o(){return Object(n["a"])({url:"get_job_summary",method:"get"})}function l(t){return console.log(t),Object(n["a"])({url:"get_job_details?job_id="+t,method:"get"})}function r(t){return Object(n["a"])({url:"get_job_list",method:"get",param:t})}function i(){return Object(n["a"])({url:"get_machine_info",method:"get"})}},"76fe":function(t,e,a){"use strict";a.d(e,"g",(function(){return o})),a.d(e,"f",(function(){return l})),a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return i})),a.d(e,"e",(function(){return c})),a.d(e,"d",(function(){return s})),a.d(e,"c",(function(){return u}));var n=a("b775");function o(t){return Object(n["a"])({url:"rerun_job",method:"post",data:{job_id:t}})}function l(t){return Object(n["a"])({url:"kill_job",method:"post",data:{job_id:t}})}function r(t){return Object(n["a"])({url:"copy_job",method:"post",data:{job_id:t}})}function i(t){return Object(n["a"])({url:"delete_job",method:"post",data:{job_id:t}})}function c(t){return Object(n["a"])({url:"insert_job",method:"post",data:t})}function s(){return Object(n["a"])({url:"get_job_type_batch",method:"get"})}function u(){return Object(n["a"])({url:"get_all_job_file",method:"get"})}},"79de":function(t,e,a){"use strict";var n=a("24d4"),o=a.n(n);o.a},a4d9:function(t,e,a){"use strict";var n=a("44a5"),o=a.n(n);o.a},b775:function(t,e,a){"use strict";a("d3b7");var n=a("bc3a"),o=a.n(n),l=a("5c96"),r=a("4360"),i=a("5f87"),c=o.a.create({baseURL:"/",timeout:5e3});c.interceptors.request.use((function(t){return r["a"].getters.token&&(t.headers["X-Token"]=Object(i["a"])()),t}),(function(t){return console.log(t),Promise.reject(t)})),c.interceptors.response.use((function(t){var e=t.data;return 200!==e.code&&200!==e.status?(Object(l["Message"])({message:e.message||"Error",type:"error",duration:5e3}),50008!==e.code&&50012!==e.code&&50014!==e.code||l["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then((function(){r["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),Promise.reject(new Error(e.message||"Error"))):e}),(function(t){return console.log("err"+t),Object(l["Message"])({message:t.message,type:"error",duration:5e3}),Promise.reject(t)})),e["a"]=c},d0a1:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"job-list"}},[a("job-table")],1)},o=[],l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"job-table"}},[a("h3",[t._v("job list")]),a("el-table",{ref:"multipleTable",attrs:{data:t.tableData},on:{"row-click":t.toJob,"selection-change":t.handleSelectionChange,"filter-change":t.filterChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"id",label:"id",width:"40"}}),a("el-table-column",{attrs:{prop:"job_type",label:"job_type","column-key":"type",filters:t.typeFilters,"filter-method":t.typeHandler,width:"100"}}),a("el-table-column",{attrs:{prop:"batch",label:"batch","column-key":"batch",filters:t.batchFilters,"filter-method":t.batchHandler,width:"100"}}),a("el-table-column",{attrs:{prop:"priority",label:"priority",width:"100"}}),a("el-table-column",{attrs:{prop:"limit_count",label:"limit_count",width:"100"}}),a("el-table-column",{attrs:{prop:"tag",label:"tag",width:"100"}}),a("el-table-column",{attrs:{prop:"input_data",label:"input_data",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"top-start",title:"input_data",width:"300",trigger:"hover",content:e.row.input_data}},[a("el-button",{attrs:{slot:"reference"},slot:"reference"},[t._v("data")])],1)]}}])}),a("el-table-column",{attrs:{prop:"result",label:"result",width:"100"}}),a("el-table-column",{attrs:{prop:"return_count",label:"return_count",width:"100"}}),a("el-table-column",{attrs:{prop:"spend_time",label:"spend_time",width:"100"}}),a("el-table-column",{attrs:{prop:"status",label:"status",width:"100"}}),a("el-table-column",{attrs:{prop:"machine_id",label:"machine_id",width:"100"}}),a("el-table-column",{attrs:{prop:"create_time",label:"create_time",width:"100"}}),a("el-table-column",{attrs:{prop:"update_time",label:"update_time",width:"100"}})],1),a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[5,10,20],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next",total:t.showData.length},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-button",{nativeOn:{click:function(e){return t.rerun(e)}}},[t._v("重跑任务")])],1),a("el-col",{attrs:{span:6}},[a("el-button",{nativeOn:{click:function(e){return t.kill(e)}}},[t._v("关闭任务")])],1),a("el-col",{attrs:{span:6}},[a("el-button",{nativeOn:{click:function(e){return t.copy(e)}}},[t._v("复制任务")])],1),a("el-col",{attrs:{span:6}},[a("el-button",{nativeOn:{click:function(e){return t.deleteTask(e)}}},[t._v("删除任务")])],1)],1)],1)},r=[],i=(a("99af"),a("4160"),a("c975"),a("fb6a"),a("a434"),a("159b"),a("2909")),c=a("b85c"),s=a("450a"),u=a("76fe"),h={name:"JobTable",data:function(){return{filterData:[],typeList:[],typeChosen:[],batchChosen:[],typeFilters:[],batchList:[],batchFilters:[],pageSize:10,currentPage:1,data:[],showData:[],tableData:[],multipleSelection:[]}},created:function(){var t=this,e={job_type:"",batch:"",offset_num:0,limit_num:100};Object(s["b"])(e).then((function(e){console.log(e.data),t.data=e.data,t.showData=e.data,t.tableData=t.showData.slice(0,Math.min(t.pageSize,t.showData.length))})),Object(u["d"])().then((function(e){console.log(e.data),t.filterData={};var a,n=Object(c["a"])(e.data);try{for(n.s();!(a=n.n()).done;){var o,l=a.value;t.typeList.push(l.job_type),t.filterData[l.job_type]=l.batch,(o=t.batchList).push.apply(o,Object(i["a"])(l.batch)),t.typeFilters.push({text:l.job_type,value:l.job_type})}}catch(h){n.e(h)}finally{n.f()}var r,s=Object(c["a"])(t.batchList);try{for(s.s();!(r=s.n()).done;){var u=r.value;t.batchFilters.push({text:u,value:u})}}catch(h){s.e(h)}finally{s.f()}console.log(t.filterData)}))},methods:{firstPage:function(){},toJob:function(t){console.log(t),console.log("/details/"+t.id),this.$router.push({path:"/details",query:{id:t.id}})},toggleSelection:function(t){var e=this;t?t.forEach((function(t){e.$refs.multipleTable.toggleRowSelection(t)})):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(t){this.multipleSelection=[];var e,a=Object(c["a"])(t);try{for(a.s();!(e=a.n()).done;){var n=e.value;this.multipleSelection.push(n.id)}}catch(o){a.e(o)}finally{a.f()}console.log(this.multipleSelection)},rerun:function(){Object(u["g"])([this.data.id]).then((function(t){console.log(t.data)}))},kill:function(){Object(u["f"])([this.data.id]).then((function(t){console.log(t.data)}))},copy:function(){Object(u["a"])([this.data.id]).then((function(t){console.log(t.data)}))},deleteTask:function(){Object(u["b"])([this.data.id]).then((function(t){console.log(t.data)}))},handleCurrentChange:function(t){var e;console.log("当前页: ".concat(t)),this.tableData=[],(e=this.tableData).splice.apply(e,[0,0].concat(Object(i["a"])(this.showData.slice((t-1)*this.pageSize,Math.min(t*this.pageSize,this.showData.length))))),console.log(this.tableData)},handleSizeChange:function(t){var e;this.pageSize=t,this.tableData=[],(e=this.tableData).splice.apply(e,[0,0].concat(Object(i["a"])(this.showData.slice(0,Math.min(this.pageSize,this.showData.length)))))},typeHandler:function(t,e,a){var n=a["property"];return e[n]===t},batchHandler:function(t,e,a){var n=a["property"];return e[n]===t},filterChange:function(t){var e;t.type&&(this.typeChosen=t.type),t.batch&&(this.batchChosen=t.batch),console.log(t),this.showData=[];var a,n=Object(c["a"])(this.data);try{for(n.s();!(a=n.n()).done;){var o=a.value;this.typeChosen.length>0&&this.typeChosen.indexOf(o.job_type)<0||(this.batchChosen.length>0&&this.batchChosen.indexOf(o.batch)<0||this.showData.push(o))}}catch(l){n.e(l)}finally{n.f()}this.pageSize=this.showData.length,this.currentPage=1,this.tableData=[],(e=this.tableData).splice.apply(e,[0,0].concat(Object(i["a"])(this.showData.slice(0,Math.min(this.pageSize,this.showData.length)))))}}},b=h,d=(a("a4d9"),a("2877")),p=Object(d["a"])(b,l,r,!1,null,"412a994e",null),f=p.exports,g={components:{JobTable:f}},m=g,_=(a("79de"),Object(d["a"])(m,n,o,!1,null,"150d8b38",null));e["default"]=_.exports}}]);